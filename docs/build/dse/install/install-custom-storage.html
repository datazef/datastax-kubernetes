

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Install custom storage &mdash; DSE On Kubernetes 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configure SSL certificates" href="configure-certs.html" />
    <link rel="prev" title="Install cass-operator" href="install-cass-operator.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> DSE On Kubernetes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/index.html">Cloud</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../kubernetes/index.html">Kubernetes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">DSE</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Provisioning</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install-cass-operator.html">Install cass-operator</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Install custom storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure">Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-requisites">Post-requisites</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configure-certs.html">Configure SSL certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="create-datacenter.html">Create a Cassandra cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="delete-all.html">Delete all</a></li>
<li class="toctree-l3"><a class="reference internal" href="delete-cass-operator.html">Delete cass-operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../use/index.html">Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manage/index.html">Manage</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../monitoring/index.html">Monitoring</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DSE On Kubernetes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">DSE</a> &raquo;</li>
        
          <li><a href="index.html">Provisioning</a> &raquo;</li>
        
      <li>Install custom storage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/dse/install/install-custom-storage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="install-custom-storage">
<h1>Install custom storage<a class="headerlink" href="#install-custom-storage" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is in addition to all notes available on DataStax <a class="reference external" href="https://docs.datastax.com/en/cass-operator/doc/cass-operator/cassOperatorTOC.html">https://docs.datastax.com/en/cass-operator/doc/cass-operator/cassOperatorTOC.html</a> and to the information available <a class="reference external" href="https://github.com/datastax/cass-operator">https://github.com/datastax/cass-operator</a></p>
</div>
<div class="section" id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h2>
<p>Before you start, make sure you have performed the following tasks:</p>
<ul class="simple">
<li><a class="reference internal" href="install-cass-operator.html"><span class="doc">Install cass-operator</span></a></li>
</ul>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Storage class:</li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: server-storage
provisioner: kubernetes.io/gce-pd
parameters:
  type: pd-ssd
  replication-type: none
volumeBindingMode: WaitForFirstConsumer
reclaimPolicy: Delete
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>reclaimPolicy: Delete =&gt; If you do not want to storage to be deleted at the same time as the pod, you can set the option reclaimPolicy to Retain to avoid the data to be deleted.</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>volumeBindingMode: WaitForFirstConsumer =&gt; the default value is Immediate and should not be used. It can prevent Cassandra pods from being scheduled on a worker node. If a pod fails to run and its status reports a message like, had volume node affinity conflict, then check the volumeBindingMode of the StorageClass being used. See Topology-Aware Volume Provisioning in Kubernetes for more details.</li>
</ul>
</div>
<ul class="simple">
<li>Create the optimized storage class:</li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$&gt; kubectl create -f k8s-build/templates/cassandra/storage.yaml
<span class="hll">storageclass.storage.k8s.io/server-storage created
</span></pre></div>
</div>
</div>
<div class="section" id="post-requisites">
<h2>Post-requisites<a class="headerlink" href="#post-requisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Check if all resources are created:</li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$&gt; kubectl -n cass-operator get sc
NAME                 PROVISIONER            AGE
<span class="hll">server-storage       kubernetes.io/gce-pd   101s
</span>standard <span class="o">(</span>default<span class="o">)</span>   kubernetes.io/gce-pd   81m
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configure-certs.html" class="btn btn-neutral float-right" title="Configure SSL certificates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install-cass-operator.html" class="btn btn-neutral float-left" title="Install cass-operator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, DataStax

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>